<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campaign2025</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Rashi+Hebrew&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Heebo&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Heebo', sans-serif;
      background: url('/mnt/data/Untitled-1 (1).jpg') no-repeat center center fixed;
      background-color: #000;
      background-size: cover;
      color: white;
      direction: rtl;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    /* מצב אתחולי – רק הלוגו במרכז הדף */
    #initial-state {
      height: 100vh;
    }
    #logo-button {
      cursor: pointer;
    }
    #logo-button img {
      height: 150px;
    }
    /* הודעת טעינה */
    #loading {
      display: none;
      font-size: 20px;
      color: white;
      margin-top: 20px;
    }
    /* Header */
    #header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .header-text {
      font-size: 30px;
      color: white;
    }
    /* פס התקדמות */
    .global-progress-bar {
      width: 100%;
      background-color: #f0f0f0;
      border-radius: 5px;
      height: 30px;
      margin-top: 20px;
    }
    .global-progress {
      height: 100%;
      background-color: #fdc344;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div id="initial-state">
    <div id="logo-button" onclick="startFetching()">
      <img src="https://1drv.ms/i/c/e5a7cb55ec96710f/IQSdb7atOWWMTZsILGE-SkXnASj-z4532-tWziRrJg2IE38?width=1024" alt="Logo">
    </div>
  </div>
  <div id="loading">נטען...</div>
  <div id="content-wrapper" style="display: none;">
    <div id="header">
      <div id="logo-button" onclick="fetchPeople()">
        <img src="https://1drv.ms/i/c/e5a7cb55ec96710f/IQSdb7atOWWMTZsILGE-SkXnASj-z4532-tWziRrJg2IE38?width=1024" alt="Logo">
      </div>
      <div class="header-text">
        נאסף עד כה: <span id="global-progress-text">0</span> ₪ מתוך 150,000 ₪ (<span id="global-progress-percentage">0%</span>)
      </div>
    </div>
    <div class="global-progress-bar">
      <div id="global-progress" class="global-progress" style="width: 0%;"></div>
    </div>
  </div>
  <script>
    let allData = "0";
    function startFetching() {
      document.getElementById("initial-state").style.display = "none";
      document.getElementById("loading").style.display = "block";
      fetchPeople();
    }
    function fetchPeople() {
      fetch('https://hook.eu2.make.com/utretx4h3a1757e9s6v99ldn72gfu72u', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ request: 'fetch_people' })
      })
      .then(response => response.json())
      .then(data => {
        document.getElementById("loading").style.display = "none";
        document.getElementById("content-wrapper").style.display = "block";
        updateGlobalProgress(data);
      })
      .catch(error => {
        console.error("Error fetching data:", error);
        document.getElementById("loading").style.display = "none";
        alert("שגיאה בטעינת המידע");
      });
    }
    function updateGlobalProgress(data) {
      const globalTarget = 150000;
      const totalAll = parseInt(allData) || 0;
      const progressWidth = (totalAll / globalTarget) * 100;
      document.getElementById("global-progress-text").innerText = formatNumber(totalAll) + " ₪";
      document.getElementById("global-progress-percentage").innerText = `${Math.min(progressWidth, 100).toFixed(2)}%`;
      document.getElementById("global-progress").style.width = `${Math.min(progressWidth, 100)}%`;
    }
    function formatNumber(number) {
      return parseInt(number).toLocaleString('en');
    }
  </script>
</body>
</html>
